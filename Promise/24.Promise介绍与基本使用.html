<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
        // Promise
        // Promise 是 ES6 引入的异步编程的新解决方案。语法上Promise是一个构造函数
        // 用来封装异步操作并可以获取其成功或失败的结果
        // (1) Promise 构造函数: Promise(excutor){}
        // (2) Promise.prototype.then 方法
        // (3) Promise.prototype.catch 方法

        // 实例化 Promise 对象
        const p = new Promise(function(resolve,reject){
            setTimeout(function(){
                // 在异步操作中可以获取些数据
                let data = "数据库中的用户数据";
                // 获取数据以后，可以调用resolve和reject来改变promise对象的一个状态
                // 调用resolve后，p的状态就会变为成功   promise对象主要有三个状态:初始化、成功、失败
                // p状态变为成功后，就可以调用对象的方法then
                resolve(data);

                // 如果数据读取的时候发生了错误,调用reject函数
                // 就会调用then方法的第二个函数
                let err = "数据读取失败";
                reject(err);
            },1000);
        });
        
        // 通过这样的方式就把异步任务封装在了Promise里面
        // 而且通过resolve和reject这两个函数来改变他的状态，改变状态后去调用then方法里面的回调
        // 如果成功就调用then里面第一个函数，如果失败就调用then里面第二个函数


        // 调用 Promise 对象的 then 方法
        // then方法接收两个参数，两个参数都是函数类型的值
        // 两个函数都有一个形参，成功的形参有一个value，失败的形参为reason
        p.then(function(value){
            console.log(value);   // 使用了resolve，then函数就会执行第一个函数里面的方法
                                    // 输出 "数据库中的用户数据"
        }, function(reason) {
            console.error(reason);
        })

    </script>
</body>
</html>